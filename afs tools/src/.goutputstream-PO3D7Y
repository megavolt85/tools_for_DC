#include "win.h"

AFSToolsWindow::AFSToolsWindow()
{
	cur_mode = 0;
	
	//fbrowser1->callback((Fl_Callback *) cb_browser_click_callback, this);
	//fbrowser1->filetype(0);
	fbrowser1->filter("*.afs");
	fbrowser1->load("infiles/");
	
	btn_pack->callback((Fl_Callback *) cb_btn_pack_callback, this);
	btn_unpack->callback((Fl_Callback *) cb_btn_unpack_callback, this);
}

void AFSToolsWindow::show()
{
	//mode_sel->show();
	
	m_window->show();
}

void AFSToolsWindow::cb_btn_pack_callback(Fl_Widget *btn, void* userdata)
{
	if (((AFSToolsWindow*)userdata)->get_cur_mode())
		return;
	
	((AFSToolsWindow*)userdata)->set_cur_mode(1);
	
	//((AFSToolsWindow*)userdata)->fbrowser1->filetype(0);
	((AFSToolsWindow*)userdata)->fbrowser1->filter("*.lst");
	((AFSToolsWindow*)userdata)->fbrowser1->load("workdir/");
	
	printf("упаковать\n");
}

void AFSToolsWindow::cb_btn_unpack_callback(Fl_Widget *btn, void* userdata)
{
	if (!((AFSToolsWindow*)userdata)->get_cur_mode())
		return;
	
	((AFSToolsWindow*)userdata)->set_cur_mode(0);
	
	//((AFSToolsWindow*)userdata)->fbrowser1->filetype(0);
	((AFSToolsWindow*)userdata)->fbrowser1->filter("*.AFS");
	((AFSToolsWindow*)userdata)->fbrowser1->load("infiles/");
	
	printf("распаковать\n");
}
/*
void AFSToolsWindow::cb_browser_click_callback(Fl_Widget *btn, void* userdata)
{
	
}

*/
